{"remainingRequest":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iancramer/GitHub/bundlevo-vue/src/auth/register-org.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/iancramer/GitHub/bundlevo-vue/src/auth/register-org.vue","mtime":1566224143628},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1557780376697},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js","mtime":1557881577950},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1557780379303}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { InputField, InputValidate, Panel, AppButton, ProgressTracker, ProgressTrackerStep, ErrorBanner } from '@/components';\nimport api from '@/api';\nimport { IOrganization, IUser, VForm } from '@/interfaces';\nimport { ValidationObserver } from 'vee-validate';\nimport deepCopy from '@/utils';\n\n@Component({\n  components: {\n    InputField,\n    Panel,\n    AppButton,\n    InputValidate,\n    ValidationObserver,\n    ProgressTracker,\n    ProgressTrackerStep,\n    ErrorBanner\n  }\n})\nexport default class RegisterOrg extends Vue {\n  org: IOrganization = { address: {} };\n  user: IUser = {};\n  errorList: string[] = [];\n  validate = {\n    user: undefined,\n    createOrg: undefined\n  }\n  newUserId: number;\n\n  mounted() {\n    this.validate.user = (this.$refs.user as VForm).validate;\n    this.validate.createOrg = (this.$refs.createOrg as VForm).validate;\n  }\n\n  submitUser() {\n    (this.$refs.user as VForm).validate().then( valid => {\n      if(valid) {\n        let body = deepCopy(this.user);\n        delete body.confirmPassword;\n        api.post('/user/', body).then(resp => {\n          const token = resp.headers.authorization;\n          sessionStorage.setItem('jwt', token);\n          this.newUserId = resp.data.id;\n        }).catch( error => {\n          this.errorList.push(error.response.data.message);\n        });\n      }\n    });\n  }\n\n  submitOrg() {\n    (this.$refs.orgIfno as VForm).validate().then( valid => {\n      if(valid) {\n        api.post('organization/', this.org).then(resp => {\n          let body = { id: this.newUserId, org: { id: resp.data.id } };\n          api.put('user', body).then(resp => {\n            this.$router.push('/dashboard');\n          }).catch( error => {\n            this.errorList.push(error.response.data.message);\n          });\n        }).catch( error => {\n          this.errorList.push(error.response.data.message);\n        });\n      }\n    });\n  }\n}\n",{"version":3,"sources":["register-org.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"register-org.vue","sourceRoot":"src/auth","sourcesContent":["<template>\n    <div class=\"row auth\">\n      <div class=\"col\">\n        <div class=\"parallels1\"></div>\n        <div class=\"parallels2\"></div>\n        <img src=\"../assets/CrateVisionLogo.png\" />\n      </div>\n      <div class=\"col\">\n        <div id=\"register\">\n          <h2>New Organization</h2>\n          <error-banner v-model=\"errorList\" />\n          <progress-tracker @submit=\"submitOrg\" :showCancel=\"false\">\n            <progress-tracker-step title=\"Create User\" stepKey=\"createUser\" @next-click=\"submitUser\" :validate=\"validate.user\">\n              <validation-observer ref=\"user\" slim>\n                <form @submit.prevent=\"submitForm\">\n                  <div class=\"container\">\n                    <div class=\"row\">\n                      <div class=\"col-md-6\">\n                        <input-validate label=\"First Name\" rules=\"required\" name=\"firstName\" v-model.trim=\"user.firstName\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate label=\"Last Name\" rules=\"required\" name=\"lastName\" v-model.trim=\"user.lastName\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"password\" inputType=\"password\" rules=\"required\" vid=\"password\" label=\"Password\" v-model.trim=\"user.password\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"confirmPassword\" inputType=\"password\" rules=\"required|confirmed:password\" label=\"Confirm Password\" v-model.trim=\"user.confirmPassword\" data-vv-as=\"password\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"email\" rules=\"required|email\" label=\"Email\" v-model.trim=\"user.userName\" />\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </validation-observer>\n            </progress-tracker-step>\n            <progress-tracker-step title=\"Create Organization\" stepKey=\"createOrg\" :validate=\"validate.createOrg\">\n              <validation-observer ref=\"createOrg\" slim>\n                <form @submit.prevent=\"submitOrg\">\n                  <div class=\"container\">\n                    <div class=\"row\">\n                      <div class=\"col-md-6\">\n                        <input-validate label=\"Name\" rules=\"required\" name=\"name\" v-model.trim=\"org.name\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"phone\" rules=\"required\" label=\"Phone\" v-model=\"org.phone\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"addressLine1\" rules=\"required\" label=\"Address Line 1\" v-model.trim=\"org.address.addressLine1\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-field name=\"addressLine2\" label=\"Address Line 2\" v-model.trim=\"org.address.addressLine2\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"city\" rules=\"required\" label=\"City\" v-model.trim=\"org.address.city\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"state\" rules=\"required\" label=\"State\" v-model=\"org.address.state\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"zipCode\" rules=\"required\" label=\"Zip Code\" v-model.trim=\"org.address.zipCode\" />\n                      </div>\n                      <div class=\"col-md-6\">\n                        <input-validate name=\"country\" rules=\"required\" label=\"Country\" v-model.trim=\"org.address.country\" />\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </validation-observer>\n            </progress-tracker-step>\n          </progress-tracker>\n          <p class=\"auth-subtext\">\n            Already a member?\n            <app-button size=\"xs\" btnStyle=\"info-link\" route=\"/login\">Log In</app-button>\n          </p>\n        </div>\n      </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport { InputField, InputValidate, Panel, AppButton, ProgressTracker, ProgressTrackerStep, ErrorBanner } from '@/components';\nimport api from '@/api';\nimport { IOrganization, IUser, VForm } from '@/interfaces';\nimport { ValidationObserver } from 'vee-validate';\nimport deepCopy from '@/utils';\n\n@Component({\n  components: {\n    InputField,\n    Panel,\n    AppButton,\n    InputValidate,\n    ValidationObserver,\n    ProgressTracker,\n    ProgressTrackerStep,\n    ErrorBanner\n  }\n})\nexport default class RegisterOrg extends Vue {\n  org: IOrganization = { address: {} };\n  user: IUser = {};\n  errorList: string[] = [];\n  validate = {\n    user: undefined,\n    createOrg: undefined\n  }\n  newUserId: number;\n\n  mounted() {\n    this.validate.user = (this.$refs.user as VForm).validate;\n    this.validate.createOrg = (this.$refs.createOrg as VForm).validate;\n  }\n\n  submitUser() {\n    (this.$refs.user as VForm).validate().then( valid => {\n      if(valid) {\n        let body = deepCopy(this.user);\n        delete body.confirmPassword;\n        api.post('/user/', body).then(resp => {\n          const token = resp.headers.authorization;\n          sessionStorage.setItem('jwt', token);\n          this.newUserId = resp.data.id;\n        }).catch( error => {\n          this.errorList.push(error.response.data.message);\n        });\n      }\n    });\n  }\n\n  submitOrg() {\n    (this.$refs.orgIfno as VForm).validate().then( valid => {\n      if(valid) {\n        api.post('organization/', this.org).then(resp => {\n          let body = { id: this.newUserId, org: { id: resp.data.id } };\n          api.put('user', body).then(resp => {\n            this.$router.push('/dashboard');\n          }).catch( error => {\n            this.errorList.push(error.response.data.message);\n          });\n        }).catch( error => {\n          this.errorList.push(error.response.data.message);\n        });\n      }\n    });\n  }\n}\n</script>\n"]}]}