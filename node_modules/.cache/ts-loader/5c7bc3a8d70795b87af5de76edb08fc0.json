{"remainingRequest":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js??ref--14-2!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/product-info.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/product-info.vue","mtime":1564768508916},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1557780376697},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js","mtime":1557881577950},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1557780379303}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _classCallCheck from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Vue } from 'vue-property-decorator';\nimport { Panel, ListGroup, ListGroupItem, NoResults, Badge, DataImage, AppTable, Modal, AppButton, Counter, SectionTitle, ImageGallery, InputField, InputValidate, MultiSelect, StatusSelect, Radio, FeeInput, FeeEditor, ImageEditor, ButtonGroup, ErrorBanner, Toggle, Pagination } from '@/components';\nimport { DoughnutChart } from '@/charts';\nimport api from '@/api';\nimport ProductItemPanel from \"./product-item-panel.vue\";\nimport NewProductItem from \"./product-items/new-product-item.vue\";\nimport deepCopy from '@/utils';\nimport { ValidationObserver } from 'vee-validate';\nimport ProductIdentifier from \"./product-items/product-identifier.vue\";\nimport Inventory from \"./product-items/inventory.vue\";\n\nvar ProductInfo =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(ProductInfo, _Vue);\n\n  function ProductInfo() {\n    var _this;\n\n    _classCallCheck(this, ProductInfo);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProductInfo).apply(this, arguments));\n    _this.product = {};\n    _this.chartData = {};\n    _this.summaryData = {};\n    _this.productImages = [];\n    _this.productItems = [];\n    _this.filteredProdItems = [];\n    _this.productItemQty = [];\n    _this.selectedItem = {};\n    _this.showDetails = false;\n    _this.saveDisabled = true;\n    _this.showNewItemModal = false;\n    _this.editProdItems = false;\n    _this.showBasicModal = false;\n    _this.basicInfoEditObj = {};\n    _this.showFeeModal = false;\n    _this.editFeeOptions = false;\n    _this.feeEditArr = [];\n    _this.showImageModal = false;\n    _this.images = [];\n    _this.itemCols = [{\n      label: 'Quantity',\n      slotName: 'count'\n    }, {\n      label: 'Name',\n      slotName: 'name'\n    }, {\n      label: 'Case Cost',\n      selector: 'caseCost'\n    }, {\n      label: 'Item Cost',\n      selector: 'itemCost'\n    }, {\n      label: 'Supplier',\n      selector: 'supplier.name'\n    }];\n    _this.statusOptions = [];\n    _this.errorList = [];\n    _this.chartOptions = {\n      responsive: true,\n      maintainAspectRatio: true,\n      legend: {\n        position: 'bottom',\n        labels: {\n          boxWidth: 15,\n          fontSize: 14,\n          fontColor: '#444'\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(ProductInfo, [{\n    key: \"created\",\n    value: function created() {\n      this.getProduct();\n      this.getStatuses();\n    }\n  }, {\n    key: \"getProduct\",\n    value: function getProduct() {\n      var _this2 = this;\n\n      var id = this.$route.params.id;\n      api.get('product/' + id).then(function (resp) {\n        _this2.product = resp.data;\n        _this2.productItemQty = _this2.product.productItemQuantities || [];\n\n        if (_this2.productItemQty.length) {\n          _this2.getProductItems();\n        }\n\n        _this2.calculateCost();\n      }).catch(function (error) {\n        _this2.errorList.push(error.response.data.message);\n      });\n    }\n  }, {\n    key: \"getProductItems\",\n    value: function getProductItems() {\n      var _this3 = this;\n\n      api.get('productitem/all').then(function (resp) {\n        _this3.productItems = resp.data;\n      }).catch(function (error) {\n        _this3.errorList.push(error.response.data.message);\n      });\n    }\n  }, {\n    key: \"getStatuses\",\n    value: function getStatuses() {\n      var _this4 = this;\n\n      api.get('status/all').then(function (resp) {\n        _this4.statusOptions = resp.data;\n      }).catch(function (error) {\n        _this4.errorList.push(error.response.data.message);\n      });\n    }\n  }, {\n    key: \"calculateCost\",\n    value: function calculateCost() {\n      var product = this.product;\n      var fees = 0;\n      product.fees.forEach(function (fee) {\n        fees += fee.amount;\n      });\n      var prodItemsCost = 0;\n      product.productItemQuantities.forEach(function (item) {\n        prodItemsCost += item.productItem.itemCost * item.count;\n      });\n      prodItemsCost = parseInt(prodItemsCost.toFixed(2));\n      var cost = fees + prodItemsCost;\n      var profit = parseInt((product.msrp - cost).toFixed(2));\n\n      if (profit < 0) {\n        profit = 0;\n      }\n\n      this.chartData = {\n        labels: ['Fees', 'Product Cost', 'Profit'],\n        datasets: [{\n          data: [fees, prodItemsCost, profit],\n          backgroundColor: ['#ff6384', '#ffcd56', '#00ad10']\n        }]\n      };\n      this.summaryData = {\n        msrp: product.msrp,\n        fees: fees,\n        prodItemsCost: prodItemsCost,\n        profit: profit\n      };\n    }\n  }, {\n    key: \"changePage\",\n    value: function changePage(range) {\n      var prodItems = deepCopy(this.productItems);\n      this.filteredProdItems = prodItems.splice(range.start, range.end);\n    }\n  }, {\n    key: \"prodItemEditStart\",\n    value: function prodItemEditStart() {\n      this.filteredProdItems = this.productItems;\n      this.editProdItems = true;\n    }\n  }, {\n    key: \"prodItemEditEnd\",\n    value: function prodItemEditEnd() {\n      var _this5 = this;\n\n      this.filteredProdItems = this.productItems.filter(function (item) {\n        return _this5.getCount(item) > 0;\n      });\n      this.editProdItems = false;\n    }\n  }, {\n    key: \"findCountObj\",\n    value: function findCountObj(id) {\n      return this.productItemQty.find(function (item) {\n        return item.productItem.id === id;\n      });\n    }\n  }, {\n    key: \"getCount\",\n    value: function getCount(item) {\n      var countItem = this.findCountObj(item.id);\n      return countItem ? countItem.count : 0;\n    }\n  }, {\n    key: \"changeCount\",\n    value: function changeCount(val, item) {\n      var countItem = this.findCountObj(item.id);\n      var prodItemQty = this.productItemQty;\n      var count = val !== '' ? parseInt(val) : 0;\n\n      if (countItem) {\n        if (count === 0) {\n          var index = prodItemQty.findIndex(function (obj) {\n            return obj.productItem.id === item.id;\n          });\n          prodItemQty.splice(index, 1);\n        } else {\n          countItem.count = count;\n        }\n      } else {\n        prodItemQty.push({\n          count: count,\n          productItem: item\n        });\n      }\n\n      this.calculateCost();\n      this.saveDisabled = false;\n    }\n  }, {\n    key: \"openDetails\",\n    value: function openDetails(obj) {\n      this.showDetails = true;\n      this.selectedItem = obj;\n    }\n  }, {\n    key: \"closeDetails\",\n    value: function closeDetails() {\n      this.showDetails = false;\n      this.selectedItem = {};\n    }\n  }, {\n    key: \"openNewItemModal\",\n    value: function openNewItemModal() {\n      this.showNewItemModal = true;\n    }\n  }, {\n    key: \"closeNewItemModal\",\n    value: function closeNewItemModal() {\n      this.showNewItemModal = false;\n    }\n  }, {\n    key: \"openBasicModal\",\n    value: function openBasicModal() {\n      var prod = this.product;\n      this.basicInfoEditObj = {\n        name: prod.name,\n        msrp: prod.msrp,\n        fees: prod.fees,\n        status: prod.status\n      };\n      this.showBasicModal = true;\n    }\n  }, {\n    key: \"closeBasicModal\",\n    value: function closeBasicModal() {\n      this.showBasicModal = false;\n    }\n  }, {\n    key: \"openFeeModal\",\n    value: function openFeeModal() {\n      this.feeEditArr = this.product.fees;\n      this.showFeeModal = true;\n    }\n  }, {\n    key: \"closeFeeModal\",\n    value: function closeFeeModal() {\n      this.showFeeModal = false;\n    }\n  }, {\n    key: \"openImageModal\",\n    value: function openImageModal() {\n      this.showImageModal = true;\n    }\n  }, {\n    key: \"closeImageModal\",\n    value: function closeImageModal() {\n      this.showImageModal = false;\n    }\n  }, {\n    key: \"cancelItemEdit\",\n    value: function cancelItemEdit() {\n      this.prodItemEditEnd();\n      this.getProduct();\n    }\n  }, {\n    key: \"saveNewItem\",\n    value: function saveNewItem(value) {\n      var _this6 = this;\n\n      api.post('productitem/', value).then(function (resp) {\n        _this6.getProductItems();\n      }).catch(function (error) {\n        _this6.errorList.push(error.response.data.message);\n      });\n      this.closeNewItemModal();\n    }\n  }, {\n    key: \"submitBasic\",\n    value: function submitBasic() {\n      var _this7 = this;\n\n      this.$refs.basicInfo.validate().then(function (valid) {\n        if (valid) {\n          var body = _this7.basicInfoEditObj;\n\n          _this7.submitEdit(body);\n        }\n      });\n    }\n  }, {\n    key: \"submitFees\",\n    value: function submitFees() {\n      var body = {\n        fees: this.feeEditArr\n      };\n      this.submitEdit(body);\n    }\n  }, {\n    key: \"submitImages\",\n    value: function submitImages() {\n      var body = {\n        images: this.product.images\n      };\n      this.submitEdit(body);\n    }\n  }, {\n    key: \"submitProdItems\",\n    value: function submitProdItems() {\n      var body = {\n        productItemQuantities: this.productItemQty\n      };\n      this.submitEdit(body);\n    }\n  }, {\n    key: \"submitEdit\",\n    value: function submitEdit(body) {\n      var _this8 = this;\n\n      api.put('product/' + this.product.id, body).then(function (resp) {\n        _this8.getProduct();\n\n        _this8.$toast.success('Product updated');\n      }).catch(function (error) {\n        _this8.errorList.push(error.response.data.message);\n      });\n      this.closeBasicModal();\n      this.closeFeeModal();\n      this.closeImageModal();\n      this.editProdItems = false;\n    }\n  }]);\n\n  return ProductInfo;\n}(Vue);\n\nProductInfo = tslib_1.__decorate([Component({\n  components: {\n    Panel: Panel,\n    ListGroup: ListGroup,\n    ListGroupItem: ListGroupItem,\n    Badge: Badge,\n    DoughnutChart: DoughnutChart,\n    NoResults: NoResults,\n    DataImage: DataImage,\n    AppTable: AppTable,\n    Modal: Modal,\n    ProductItemPanel: ProductItemPanel,\n    AppButton: AppButton,\n    Counter: Counter,\n    NewProductItem: NewProductItem,\n    SectionTitle: SectionTitle,\n    ImageGallery: ImageGallery,\n    InputField: InputField,\n    InputValidate: InputValidate,\n    MultiSelect: MultiSelect,\n    StatusSelect: StatusSelect,\n    Radio: Radio,\n    FeeInput: FeeInput,\n    FeeEditor: FeeEditor,\n    ImageEditor: ImageEditor,\n    ButtonGroup: ButtonGroup,\n    ValidationObserver: ValidationObserver,\n    ErrorBanner: ErrorBanner,\n    Toggle: Toggle,\n    ProductIdentifier: ProductIdentifier,\n    Inventory: Inventory,\n    Pagination: Pagination\n  }\n})], ProductInfo);\nexport default ProductInfo;",{"version":3,"sources":["/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/product-info.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport {\n  Panel,\n  ListGroup,\n  ListGroupItem,\n  NoResults,\n  Badge,\n  DataImage,\n  AppTable,\n  Modal,\n  AppButton,\n  Counter,\n  SectionTitle,\n  ImageGallery,\n  InputField,\n  InputValidate,\n  MultiSelect,\n  StatusSelect,\n  Radio,\n  FeeInput,\n  FeeEditor,\n  ImageEditor,\n  ButtonGroup,\n  ErrorBanner,\n  Toggle,\n  Pagination\n} from '@/components';\nimport { DoughnutChart } from '@/charts';\nimport api from '@/api';\nimport { IProduct, IProductItem, IProductItemQuantity, IFee, IMedia, VForm } from '@/interfaces';\nimport ProductItemPanel from './product-item-panel.vue';\nimport NewProductItem from './product-items/new-product-item.vue';\nimport deepCopy from '@/utils';\nimport { ValidationObserver } from 'vee-validate';\nimport ProductIdentifier from './product-items/product-identifier.vue';\nimport Inventory from './product-items/inventory.vue';\n\n@Component({\n  components: {\n    Panel,\n    ListGroup,\n    ListGroupItem,\n    Badge,\n    DoughnutChart,\n    NoResults,\n    DataImage,\n    AppTable,\n    Modal,\n    ProductItemPanel,\n    AppButton,\n    Counter,\n    NewProductItem,\n    SectionTitle,\n    ImageGallery,\n    InputField,\n    InputValidate,\n    MultiSelect,\n    StatusSelect,\n    Radio,\n    FeeInput,\n    FeeEditor,\n    ImageEditor,\n    ButtonGroup,\n    ValidationObserver,\n    ErrorBanner,\n    Toggle,\n    ProductIdentifier,\n    Inventory,\n    Pagination\n  }\n})\nexport default class ProductInfo extends Vue {\n  product: IProduct = {};\n  chartData: any = {};\n  summaryData: any = {};\n  productImages = [];\n  productItems: IProductItem[] = [];\n  filteredProdItems: IProductItem[] = [];\n  productItemQty: IProductItemQuantity[] = [];\n  selectedItem = {};\n  showDetails = false;\n  saveDisabled = true;\n  showNewItemModal = false;\n  editProdItems = false;\n  showBasicModal = false;\n  basicInfoEditObj: IProduct = {};\n  showFeeModal = false;\n  editFeeOptions = false;\n  feeEditArr: IFee[] = [];\n  showImageModal = false;\n  images: IMedia[] = [];\n  selectedImages: IMedia[];\n  itemCols = [\n    { label: 'Quantity', slotName: 'count' },\n    { label: 'Name', slotName: 'name' },\n    { label: 'Case Cost', selector: 'caseCost' },\n    { label: 'Item Cost', selector: 'itemCost' },\n    { label: 'Supplier', selector: 'supplier.name' }\n  ];\n  statusOptions = [];\n  errorList: string[] = [];\n  chartOptions = {\n    responsive: true,\n    maintainAspectRatio: true,\n    legend: { position: 'bottom', labels: { boxWidth: 15, fontSize: 14, fontColor: '#444'}}\n  };\n\n  created() {\n    this.getProduct();\n    this.getStatuses();\n  }\n\n  getProduct() {\n    const id = this.$route.params.id;\n    api.get('product/' + id).then(resp => {\n      this.product = resp.data;\n      this.productItemQty = this.product.productItemQuantities || [];\n      if(this.productItemQty.length) {\n        this.getProductItems();\n      }\n      this.calculateCost();\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n  }\n\n  getProductItems() {\n    api.get('productitem/all').then(resp => {\n      this.productItems = resp.data;\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n  }\n\n  getStatuses() {\n    api.get('status/all').then(resp => {\n      this.statusOptions = resp.data;\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n  }\n\n  calculateCost() {\n    let product = this.product;\n    let fees = 0;\n    product.fees.forEach( fee => {\n      fees += fee.amount;\n    });\n\n    let prodItemsCost = 0;\n    product.productItemQuantities.forEach( item => {\n      prodItemsCost += item.productItem.itemCost * item.count;\n    });\n    prodItemsCost = parseInt(prodItemsCost.toFixed(2));\n    const cost = fees + prodItemsCost;\n    let profit = parseInt((product.msrp - cost).toFixed(2));\n    if(profit < 0) {\n      profit = 0;\n    }\n\n    this.chartData = {\n      labels: ['Fees', 'Product Cost', 'Profit'],\n      datasets: [{\n        data: [fees, prodItemsCost, profit],\n        backgroundColor: ['#ff6384', '#ffcd56', '#00ad10']\n      }]\n    }\n\n    this.summaryData = {\n      msrp: product.msrp,\n      fees: fees,\n      prodItemsCost: prodItemsCost,\n      profit: profit\n    }\n  }\n\n  changePage(range) {\n    let prodItems = deepCopy(this.productItems);\n    this.filteredProdItems = prodItems.splice(range.start, range.end);\n  }\n\n  prodItemEditStart() {\n    this.filteredProdItems = this.productItems;\n    this.editProdItems = true;\n  }\n\n  prodItemEditEnd() {\n    this.filteredProdItems = this.productItems.filter(item => this.getCount(item) > 0);\n    this.editProdItems = false;\n  }\n\n  findCountObj(id) {\n    return this.productItemQty.find(item => item.productItem.id === id);\n  }\n\n  getCount(item) {\n    let countItem = this.findCountObj(item.id);\n    return countItem ? countItem.count : 0;\n  }\n\n  changeCount(val, item) {\n    let countItem = this.findCountObj(item.id);\n    let prodItemQty = this.productItemQty;\n    let count = val !== '' ? parseInt(val) : 0;\n    if (countItem) {\n      if (count === 0) {\n        let index = prodItemQty.findIndex(obj => obj.productItem.id === item.id);\n        prodItemQty.splice(index, 1);\n      }\n      else {\n        countItem.count = count;\n      }\n    }\n    else {\n      prodItemQty.push({ count: count, productItem: item });\n    }\n    this.calculateCost();\n    this.saveDisabled = false;\n  }\n\n  openDetails(obj) {\n    this.showDetails = true;\n    this.selectedItem = obj;\n  }\n\n  closeDetails() {\n    this.showDetails = false;\n    this.selectedItem = {};\n  }\n\n  openNewItemModal() {\n    this.showNewItemModal = true;\n  }\n\n  closeNewItemModal() {\n    this.showNewItemModal = false;\n  }\n\n  openBasicModal() {\n    let prod = this.product;\n    this.basicInfoEditObj = {\n      name: prod.name,\n      msrp: prod.msrp,\n      fees: prod.fees,\n      status: prod.status\n    };\n    this.showBasicModal = true;\n  }\n\n  closeBasicModal() {\n    this.showBasicModal = false;\n  }\n\n  openFeeModal() {\n    this.feeEditArr = this.product.fees;\n    this.showFeeModal = true;\n  }\n\n  closeFeeModal() {\n    this.showFeeModal = false;\n  }\n\n  openImageModal() {\n    this.showImageModal = true;\n  }\n\n  closeImageModal() {\n    this.showImageModal = false;\n  }\n\n  cancelItemEdit() {\n    this.prodItemEditEnd();\n    this.getProduct();\n  }\n\n  saveNewItem(value) {\n    api.post('productitem/', value).then(resp => {\n      this.getProductItems();\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n    this.closeNewItemModal();\n  }\n\n  submitBasic() {\n    (this.$refs.basicInfo as VForm).validate().then( valid => {\n      if(valid) {\n        let body = this.basicInfoEditObj;\n        this.submitEdit(body);\n      }\n    });\n  }\n\n  submitFees() {\n    let body = { fees: this.feeEditArr };\n    this.submitEdit(body);\n  }\n\n  submitImages() {\n    let body = { images: this.product.images };\n    this.submitEdit(body);\n  }\n\n  submitProdItems() {\n    let body = { productItemQuantities: this.productItemQty };\n    this.submitEdit(body);\n  }\n\n  submitEdit(body) {\n    api.put('product/' + this.product.id, body).then(resp => {\n      this.getProduct();\n      this.$toast.success('Product updated');\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n    this.closeBasicModal();\n    this.closeFeeModal();\n    this.closeImageModal();\n    this.editProdItems = false;\n  }\n}\n"],"sourceRoot":""}]}