{"remainingRequest":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js??ref--14-2!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/new-product.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/new-product.vue","mtime":1582812150951},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1557780376697},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-plugin-typescript/node_modules/ts-loader/index.js","mtime":1557881577950},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1557780378880},{"path":"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1557780379303}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/iancramer/GitHub/bundlevo-vue/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Vue, Watch } from 'vue-property-decorator';\nimport { Panel, AppTable, AppButton, ButtonGroup, TitleBar, InputField, InputValidate, Radio, SelectBox, Counter, ListGroup, ListGroupItem, Badge, Tab, NoResults, FileUploader, Dropdown, FeeEditor, FeeInput, Modal, ErrorBanner, Toggle, Pagination, SectionTitle } from '@/components';\nimport { ValidationObserver } from 'vee-validate';\nimport api from '@/api';\nimport { DoughnutChart } from '@/charts';\nimport ProductItemPanel from \"./product-item-panel.vue\";\nimport NewProductItem from \"./product-items/new-product-item.vue\";\nimport deepCopy from '@/utils';\nimport InventoryForm from '@/pages/products/product-items/inventory-form.vue';\nimport ProductIdentifierForm from '@/pages/products/product-items/product-identifier-form.vue';\nimport { WarehouseEditor } from '@/patterns';\n\nvar NewProduct =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(NewProduct, _Vue);\n\n  function NewProduct() {\n    var _this;\n\n    _classCallCheck(this, NewProduct);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewProduct).apply(this, arguments));\n    _this.productItems = [];\n    _this.filteredProdItems = [];\n    _this.newProduct = {\n      productItemQuantities: [],\n      images: [],\n      fees: [],\n      inventory: [{}],\n      productIdentifiers: [{}]\n    };\n    _this.statusOptions = [];\n    _this.selectedProdItem = {};\n    _this.showProdDetails = false;\n    _this.columns = [{\n      label: 'Quantity',\n      slotName: 'count'\n    }, {\n      label: 'Name',\n      slotName: 'name'\n    }, {\n      label: 'Case Quantity',\n      selector: 'caseQty'\n    }, {\n      label: 'Case Cost',\n      selector: 'caseCost'\n    }, {\n      label: 'Item Cost',\n      selector: 'itemCost'\n    }, {\n      label: 'Supplier',\n      selector: 'supplier.name'\n    }];\n    _this.chartData = {};\n    _this.summaryData = {};\n    _this.chartOptions = {\n      responsive: true,\n      maintainAspectRatio: true,\n      legend: {\n        position: 'bottom',\n        labels: {\n          boxWidth: 15,\n          fontSize: 14,\n          fontColor: '#444'\n        }\n      }\n    };\n    _this.showModal = false;\n    _this.showFeeModal = false;\n    _this.showImageModal = false;\n    _this.showWarehouseModal = false;\n    _this.errorList = [];\n    return _this;\n  }\n\n  _createClass(NewProduct, [{\n    key: \"created\",\n    value: function created() {\n      this.getProductItems();\n      this.getStatuses();\n    }\n  }, {\n    key: \"updateCost\",\n    value: function updateCost() {\n      this.calculateCost();\n    }\n  }, {\n    key: \"hasInfo\",\n    value: function hasInfo() {\n      var product = this.newProduct;\n      return product.name || product.productItemQuantities.length || product.fees.length || product.images.length;\n    }\n  }, {\n    key: \"getProductItems\",\n    value: function getProductItems() {\n      var _this2 = this;\n\n      api.get('productitem/all').then(function (resp) {\n        _this2.productItems = resp.data;\n        _this2.filteredProdItems = resp.data;\n      }).catch(function (error) {\n        _this2.errorList.push(error.response.data.message);\n      });\n    }\n  }, {\n    key: \"changePage\",\n    value: function changePage(range) {\n      var prodItems = deepCopy(this.productItems);\n\n      if (prodItems) {\n        this.filteredProdItems = prodItems.splice(range.start, range.end);\n      }\n    }\n  }, {\n    key: \"getStatuses\",\n    value: function getStatuses() {\n      var _this3 = this;\n\n      api.get('status/all').then(function (resp) {\n        _this3.statusOptions = resp.data;\n      }).catch(function (error) {\n        _this3.errorList.push(error.response.data.message);\n      });\n    }\n  }, {\n    key: \"hasCost\",\n    value: function hasCost() {\n      var product = this.newProduct;\n      return product.msrp || product.fees.length || product.productItemQuantities.length;\n    }\n  }, {\n    key: \"calculateCost\",\n    value: function calculateCost() {\n      var product = this.newProduct;\n\n      if (!this.hasCost()) {\n        return;\n      }\n\n      var fees = 0;\n      this.newProduct.fees.length && this.newProduct.fees.forEach(function (fee) {\n        fees += fee.amount;\n      });\n      var cost;\n      var prodItemsCost = undefined;\n      prodItemsCost = 0;\n      product.productItemQuantities.forEach(function (item) {\n        prodItemsCost += item.productItem.itemCost * item.count;\n      });\n      prodItemsCost = parseInt(prodItemsCost.toFixed(2));\n      cost = fees + prodItemsCost;\n      var profit = parseInt((product.msrp - cost).toFixed(2));\n\n      if (profit < 0) {\n        profit = 0;\n      }\n\n      var labels = ['Fees', 'Product Cost', 'Profit'];\n      var data = [fees, prodItemsCost, profit];\n      this.chartData = {\n        labels: labels,\n        datasets: [{\n          data: data,\n          backgroundColor: ['#ffcd56', '#36a2eb', '#00ad10']\n        }]\n      };\n      this.summaryData = {\n        msrp: product.msrp,\n        fees: fees,\n        prodItemsCost: prodItemsCost,\n        profit: profit\n      };\n    }\n  }, {\n    key: \"findCountObj\",\n    value: function findCountObj(id) {\n      var prodQty = this.newProduct.productItemQuantities;\n      return prodQty.find(function (item) {\n        return item.productItem.id === id;\n      });\n    }\n  }, {\n    key: \"getCount\",\n    value: function getCount(item) {\n      var countItem = this.findCountObj(item.id);\n      return countItem ? countItem.count : 0;\n    }\n  }, {\n    key: \"changeCount\",\n    value: function changeCount(val, item) {\n      var countItem = this.findCountObj(item.id);\n      var prodQty = this.newProduct.productItemQuantities;\n      var count = val !== '' ? parseInt(val) : 0;\n\n      if (countItem) {\n        if (count === 0) {\n          var index = prodQty.findIndex(function (obj) {\n            return obj.productItem.id === item.id;\n          });\n          prodQty.splice(index, 1);\n        } else {\n          countItem.count = count;\n        }\n      } else {\n        prodQty.push({\n          count: count,\n          productItem: item\n        });\n      }\n\n      this.calculateCost();\n    }\n  }, {\n    key: \"addInventory\",\n    value: function addInventory() {\n      this.newProduct.inventory.push({});\n    }\n  }, {\n    key: \"removeInventory\",\n    value: function removeInventory(index) {\n      this.newProduct.inventory.splice(index, 1);\n    }\n  }, {\n    key: \"addProdId\",\n    value: function addProdId() {\n      this.newProduct.productIdentifiers.push({});\n    }\n  }, {\n    key: \"removeProdId\",\n    value: function removeProdId(index) {\n      this.newProduct.productIdentifiers.splice(index, 1);\n    }\n  }, {\n    key: \"removeImage\",\n    value: function removeImage(image) {\n      this.newProduct.images = this.newProduct.images.filter(function (item) {\n        return item.id != image.id;\n      });\n    }\n  }, {\n    key: \"openDetails\",\n    value: function openDetails(prodItem) {\n      this.selectedProdItem = prodItem;\n      this.showProdDetails = true;\n    }\n  }, {\n    key: \"closeDetails\",\n    value: function closeDetails(product) {\n      this.selectedProdItem = {};\n      this.showProdDetails = false;\n    }\n  }, {\n    key: \"openModal\",\n    value: function openModal() {\n      this.showModal = true;\n    }\n  }, {\n    key: \"closeModal\",\n    value: function closeModal() {\n      this.showModal = false;\n    }\n  }, {\n    key: \"saveNewItem\",\n    value: function saveNewItem(value) {\n      var _this4 = this;\n\n      api.post('productitem/', value).then(function (resp) {\n        _this4.$toast.success('New product item created');\n\n        _this4.getProductItems();\n      }).catch(function (error) {\n        _this4.errorList.push(error.response.data.message);\n      });\n      this.closeModal();\n    }\n  }, {\n    key: \"clearForm\",\n    value: function clearForm() {\n      this.newProduct = {\n        productItemQuantities: [],\n        images: [],\n        fees: [],\n        inventory: [{}],\n        productIdentifiers: [{}]\n      };\n      this.chartData.datasets = {};\n      this.$refs.newProduct.reset();\n    }\n  }, {\n    key: \"submitForm\",\n    value: function submitForm() {\n      var _this5 = this;\n\n      this.$refs.newProduct.validate().then(function (valid) {\n        if (valid) {\n          api.post('product/', _this5.newProduct).then(function () {\n            _this5.$toast.success('New product created');\n\n            _this5.clearForm();\n          }).catch(function (error) {\n            _this5.errorList.push(error.response.data.message);\n          });\n        }\n      });\n    }\n  }]);\n\n  return NewProduct;\n}(Vue);\n\ntslib_1.__decorate([Watch('newProduct', {\n  deep: true\n})], NewProduct.prototype, \"updateCost\", null);\n\nNewProduct = tslib_1.__decorate([Component({\n  components: {\n    Panel: Panel,\n    AppTable: AppTable,\n    AppButton: AppButton,\n    ButtonGroup: ButtonGroup,\n    TitleBar: TitleBar,\n    InputField: InputField,\n    InputValidate: InputValidate,\n    Radio: Radio,\n    SelectBox: SelectBox,\n    Counter: Counter,\n    ListGroup: ListGroup,\n    ListGroupItem: ListGroupItem,\n    Badge: Badge,\n    ProductItemPanel: ProductItemPanel,\n    Tab: Tab,\n    NoResults: NoResults,\n    DoughnutChart: DoughnutChart,\n    FileUploader: FileUploader,\n    Dropdown: Dropdown,\n    FeeEditor: FeeEditor,\n    FeeInput: FeeInput,\n    NewProductItem: NewProductItem,\n    Modal: Modal,\n    ValidationObserver: ValidationObserver,\n    ErrorBanner: ErrorBanner,\n    Toggle: Toggle,\n    Pagination: Pagination,\n    SectionTitle: SectionTitle,\n    InventoryForm: InventoryForm,\n    ProductIdentifierForm: ProductIdentifierForm,\n    WarehouseEditor: WarehouseEditor\n  }\n})], NewProduct);\nexport default NewProduct;",{"version":3,"sources":["/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/iancramer/GitHub/bundlevo-vue/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/iancramer/GitHub/bundlevo-vue/src/pages/products/new-product.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport {\n  Panel,\n  AppTable,\n  AppButton,\n  ButtonGroup,\n  TitleBar,\n  InputField,\n  InputValidate,\n  Radio,\n  SelectBox,\n  Counter,\n  ListGroup,\n  ListGroupItem,\n  Badge,\n  Tab,\n  NoResults,\n  FileUploader,\n  Dropdown,\n  FeeEditor,\n  FeeInput,\n  Modal,\n  ErrorBanner,\n  Toggle,\n  Pagination,\n  SectionTitle\n} from '@/components';\nimport { ValidationObserver } from 'vee-validate';\nimport api from '@/api';\nimport { IProduct, IProductItem, IFee, VForm, IProductIdentifier } from '@/interfaces';\nimport { DoughnutChart } from '@/charts';\nimport ProductItemPanel from './product-item-panel.vue';\nimport NewProductItem from './product-items/new-product-item.vue';\nimport deepCopy from '@/utils';\nimport InventoryForm from '@/pages/products/product-items/inventory-form.vue';\nimport ProductIdentifierForm from '@/pages/products/product-items/product-identifier-form.vue';\nimport { WarehouseEditor } from '@/patterns';\n\n@Component({\n  components: {\n    Panel,\n    AppTable,\n    AppButton,\n    ButtonGroup,\n    TitleBar,\n    InputField,\n    InputValidate,\n    Radio,\n    SelectBox,\n    Counter,\n    ListGroup,\n    ListGroupItem,\n    Badge,\n    ProductItemPanel,\n    Tab,\n    NoResults,\n    DoughnutChart,\n    FileUploader,\n    Dropdown,\n    FeeEditor,\n    FeeInput,\n    NewProductItem,\n    Modal,\n    ValidationObserver,\n    ErrorBanner,\n    Toggle,\n    Pagination,\n    SectionTitle,\n    InventoryForm,\n    ProductIdentifierForm,\n    WarehouseEditor\n  }\n})\nexport default class NewProduct extends Vue {\n  productItems: IProductItem[] = [];\n  filteredProdItems: IProductItem[] = [];\n  newProduct: IProduct = {\n    productItemQuantities: [],\n    images: [],\n    fees: [],\n    inventory: [{}],\n    productIdentifiers: [{}]\n  };\n  statusOptions = [];\n  selectedProdItem: IProduct = {};\n  showProdDetails = false;\n  columns = [\n    { label: 'Quantity', slotName: 'count' },\n    { label: 'Name', slotName: 'name' },\n    { label: 'Case Quantity', selector: 'caseQty' },\n    { label: 'Case Cost', selector: 'caseCost' },\n    { label: 'Item Cost', selector: 'itemCost' },\n    { label: 'Supplier', selector: 'supplier.name' }\n  ];\n  chartData: any = {};\n  summaryData: any = {};\n  chartOptions = {\n    responsive: true,\n    maintainAspectRatio: true,\n    legend: { position: 'bottom', labels: { boxWidth: 15, fontSize: 14, fontColor: '#444'}}\n  };\n  showModal = false;\n  showFeeModal = false;\n  showImageModal = false;\n  showWarehouseModal = false;\n  errorList: string[] = [];\n\n  created() {\n    this.getProductItems();\n    this.getStatuses();\n  }\n\n  @Watch('newProduct', {deep: true})\n  updateCost() {\n    this.calculateCost();\n  }\n\n  hasInfo() {\n    const product = this.newProduct;\n    return product.name || product.productItemQuantities.length || product.fees.length || product.images.length;\n  }\n\n  getProductItems() {\n    api.get('productitem/all').then(resp => {\n      this.productItems = resp.data;\n      this.filteredProdItems = resp.data;\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n  }\n\n  changePage(range) {\n    let prodItems = deepCopy(this.productItems);\n    if(prodItems) {\n      this.filteredProdItems = prodItems.splice(range.start, range.end);\n    }\n  }\n\n  getStatuses() {\n    api.get('status/all').then(resp => {\n      this.statusOptions = resp.data;\n    })\n    .catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n  }\n\n  hasCost() {\n    let product = this.newProduct;\n    return product.msrp || product.fees.length || product.productItemQuantities.length;\n  }\n\n  calculateCost() {\n    let product = this.newProduct;\n    if(!this.hasCost()) {\n      return;\n    }\n\n    let fees = 0;\n    this.newProduct.fees.length && this.newProduct.fees.forEach( fee => {\n      fees += fee.amount;\n    });\n\n    let cost: number;\n    let prodItemsCost = undefined;\n      prodItemsCost = 0;\n      product.productItemQuantities.forEach( item => {\n        prodItemsCost += item.productItem.itemCost * item.count;\n      });\n      prodItemsCost = parseInt(prodItemsCost.toFixed(2));\n      cost = fees + prodItemsCost;\n\n    let profit = parseInt((product.msrp - cost).toFixed(2));\n    if(profit < 0) {\n      profit = 0;\n    }\n\n    let labels = ['Fees', 'Product Cost', 'Profit'];\n    let data = [fees, prodItemsCost, profit];\n\n    this.chartData = {\n      labels: labels,\n      datasets: [{\n        data: data,\n        backgroundColor: ['#ffcd56', '#36a2eb', '#00ad10']\n      }]\n    }\n\n    this.summaryData = {\n      msrp: product.msrp,\n      fees: fees,\n      prodItemsCost: prodItemsCost,\n      profit: profit\n    }\n\n  }\n\n  findCountObj(id) {\n    let prodQty = this.newProduct.productItemQuantities;\n    return prodQty.find(item => item.productItem.id === id);\n  }\n\n  getCount(item) {\n    let countItem = this.findCountObj(item.id);\n    return countItem ? countItem.count : 0;\n  }\n\n  changeCount(val, item) {\n    let countItem = this.findCountObj(item.id);\n    let prodQty = this.newProduct.productItemQuantities;\n    let count = val !== '' ? parseInt(val) : 0;\n    if (countItem) {\n      if (count === 0) {\n        let index = prodQty.findIndex(obj => obj.productItem.id === item.id);\n        prodQty.splice(index, 1);\n      }\n      else {\n        countItem.count = count;\n      }\n    }\n    else {\n      prodQty.push({ count: count, productItem: item });\n    }\n    this.calculateCost();\n  }\n\n  addInventory() {\n    this.newProduct.inventory.push({});\n  }\n\n  removeInventory(index) {\n    this.newProduct.inventory.splice(index, 1);\n  }\n\n  addProdId() {\n    this.newProduct.productIdentifiers.push({});\n  }\n\n  removeProdId(index) {\n    this.newProduct.productIdentifiers.splice(index, 1);\n  }\n\n  removeImage(image) {\n    this.newProduct.images = this.newProduct.images.filter( item => item.id != image.id);\n  }\n\n  openDetails(prodItem) {\n    this.selectedProdItem = prodItem;\n    this.showProdDetails = true;\n  }\n\n  closeDetails(product) {\n    this.selectedProdItem = {};\n    this.showProdDetails = false;\n  }\n\n  openModal() {\n    this.showModal = true;\n  }\n\n  closeModal() {\n    this.showModal = false;\n  }\n\n  saveNewItem(value) {\n    api.post('productitem/', value).then(resp => {\n      this.$toast.success('New product item created');\n      this.getProductItems();\n    }).catch(error => {\n      this.errorList.push(error.response.data.message);\n    });\n    this.closeModal();\n  }\n\n  clearForm() {\n    this.newProduct = {\n      productItemQuantities: [],\n      images: [],\n      fees: [],\n      inventory: [{}],\n      productIdentifiers: [{}]\n    };\n    this.chartData.datasets = {};\n    (this.$refs.newProduct as VForm).reset();\n  }\n\n  submitForm() {\n    (this.$refs.newProduct as VForm).validate().then( valid => {\n      if(valid) {\n        api.post('product/', this.newProduct).then( () => {\n          this.$toast.success('New product created');\n          this.clearForm();\n        })\n        .catch(error => {\n          this.errorList.push(error.response.data.message);\n        });\n      }\n    });\n  }\n}\n"],"sourceRoot":""}]}